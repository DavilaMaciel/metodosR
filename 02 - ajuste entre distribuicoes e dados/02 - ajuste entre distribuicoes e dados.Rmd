---
title       : "Ajuste entre distribuições e dados"
subtitle    : "Delineamento e Estatística"
author      : "Nicholas A. C. Marino"
job         : "Universidade Federal do Rio de Janeiro"
date        : "github.com/nacmarino/metodosR"
output:
  html_document:
    widescreen: true
---

## Para que nós utilizamos os modelos de regressão?

* Um modelo de regressão visa determinar a relação entre uma ou mais variáveis resposta (_y~1~_, _y~2~_, _y~3~_,..., _y~i~_) e preditoras (_x~1~_, _x~2~_, _x~3~_,..., _x~i~_).
* Esta relação é descrita através de um modelo que tenta predizer o valor de _$\bar{y}$_ a partir de ($\beta$~0~)

<center><img src="figs/regressao_exemplo.jpeg" height="260px"></img></center>    

```{r}
set.seed(33)
dados <- round(rnorm(n = 50, mean = 100, sd = 30), digits = 0)
dados
summary(lm(dados ~ 1))
```

1. Objetivo geral deles
2. O que eles estão estimando (lm)
3. Como isso se aproxima da média
4. Como usar o fitdist para mostrar isso
5. Vale para normal, mas e as outras distribuições?
6. Overdispersion

## Que tipo de distribuição de probabilidade meus dados seguem?

* Na maior parte das vezes não temos a menor noção de que tipo de família de distribuição de probabilidade nossos dados seguem.


```{r}
set.seed(33)
dados <- round(rnorm(n = 50, mean = 100, sd = 30), digits = 0)
dados
```

* Podemos usar métodos gráficos ou testes estatísticos para descobrir se os dados se ajustam à distribuição normal.
* Métodos gráficos _vs_ métodos estatísticos:  
    + Os testes estatísticos são influenciados pelo tamanho da amostra;  
    + Os testes estatísticos são influenciados por outliers;  
    + Estes testes estatísticos são sensíveis à desvios na normalidade.  
    + __Minha recomendação__: use a visualização gráfica.  

```{r fig.align='center'}
# histograma de distribuição dos dados gerados
hist(x = dados, main = "Distribuição dos Dados", xlab = "Valores observados", ylab = "Frequência", freq = FALSE)

# QQ-Plot: plot da distribuição dos valores observados de acordo com uma expectativa teórica baseado nos quantis da distribuição
qqnorm(y = dados);qqline(y = dados)

# Teste de Shapiro-Wilk: testa a hipótese nula de que a população de dados segue a distribuição normal
shapiro.test(x = dados)
```

* Mas e quanto às outras famílias de distribuição de probabilidade?
* O pacote `fitdistrplus` oferece alguns métodos para determinamos a distribuição mais adequada para um conjunto de dados cuja natureza da distribuição de probabilidade não é conhecida.
* A função `fitdist` ajusta uma distribuição a um conjunto de dados e estima os parâmetros daquela distribuição.

```{r message=FALSE}
library(fitdistrplus)
ajuste1 <- fitdist(data = dados, distr = "norm")
coef(ajuste1)
# compare:
mean(dados) # media do vetor 'dados'
sd(dados) # desvio padrão do 'dados'
# e compara com o resultado de um modelo linear:
summary(lm(dados ~ 1))
```

> A função `fitdist` usa um estimador por verossimilhança máxima para determinar o valor mais provável para cada um dos parâmetros da distribuição de probabilidade - valor do parâmetro que minimiza a soma dos quadrados de um conjunto de dados.

* Podemos usar a função `fitdist` para ajustar outras famílias de distribuição de probabilidade.  

```{r message=FALSE}
coef(fitdist(data = dados, distr = "norm"))
coef(fitdist(data = dados, distr = "pois"))
coef(fitdist(data = dados, distr = "gamma"))
coef(fitdist(data = dados, distr = "weibull"))
coef(fitdist(data = dados, distr = "lnorm"))
```

* E a função

* Este pacote possui quatro funções muito úteis para entender e determinar o tipo de família de distribuição de probabilidade que melhor se ajusta a um conjunto de dados:
    + `fitdist`: ajusta uma distribuição a um conjunto de dados e estima os parâmetros daquela distribuição;
    + `gofstat`: computa um teste para determinar o ajuste dos dados a uma ou mais famílias de distribuição de probabilidade;
    + `cdfcomp`: método gráfico que compara o ajuste dos dados a uma ou mais famílias de distribuição de probabilidade baseado na função de distribuição cumulativa da probabilidade (probabilidade de obter um valor _x_ maior ou igual a um dado valor _X_ determinado).
    + `descdist`: método gráfico que descreve os parâmetros gerais da distribuição de um conjunto de dados, bem como uma estimativa da kurtose e obliquidade dos dados (_skewness_) - conhecido como Gráfico de Cullen e Frey.

<center><img src="figs/kurtosis.png" height="260px"></img></center>     

```{r message=FALSE}
library(fitdistrplus)
teste1 <- fitdist(dados, distr = "norm")
teste2 <- fitdist(dados, distr = "pois")
gofstat(list(teste1, teste2))
cdfcomp(list(teste1, teste2))
descdist(data = dados)
```